<?xml version="1.0" encoding="UTF-8"?>

<entity-mappings xmlns="http://java.sun.com/xml/ns/persistence/orm"
				 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
				 xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_2_1.xsd"
				 version="2.0">

	<entity class="org.lecturestudio.web.api.model.Classroom" access="FIELD">
		<table name="CLASSROOM"/>
		<attributes>
			<id name="id">
				<column name="CLASSROOM_ID"/>
				<generated-value strategy="TABLE"/>
			</id>
			<basic name="name">
				<column name="NAME" length="200"/>
			</basic>
			<basic name="shortName">
				<column name="NAME_SHORT" length="50"/>
			</basic>
			<basic name="locale">
				<column name="LOCALE"/>
			</basic>
			<one-to-many name="services" fetch="EAGER" target-entity="org.lecturestudio.web.api.model.ClassroomService">
				<cascade>
					<cascade-all/>
				</cascade>
			</one-to-many>
			<one-to-many name="documents" target-entity="org.lecturestudio.web.api.model.ClassroomDocument">
				<cascade>
					<cascade-all/>
				</cascade>
			</one-to-many>
			<element-collection name="ipFilterRules" fetch="EAGER">
				<collection-table name="IP_RULES">
					<join-column name="CLASSROOM_ID"/>
				</collection-table>
			</element-collection>
		</attributes>
	</entity>

	<entity class="org.lecturestudio.web.api.model.ClassroomDocument" name="ClassroomDocument" access="FIELD">
		<table name="CLASSROOM_DOC"/>
		<inheritance strategy="JOINED" />
		<attributes>
			<id name="id">
				<column name="ID"/>
				<generated-value strategy="TABLE"/>
			</id>
			<basic name="fileName">
				<column name="FILE_NAME" length="255"/>
			</basic>
			<basic name="checksum">
				<column name="CHECKSUM" length="120"/>
			</basic>
		</attributes>
	</entity>

	<entity class="org.lecturestudio.web.api.model.ClassroomService" name="ClassroomService" access="FIELD">
		<table name="CLASSROOM_SERVICE"/>
		<inheritance strategy="JOINED" />
		<discriminator-column name="type" discriminator-type="STRING" length="40" />
		<attributes>
			<id name="id">
				<column name="ID"/>
				<generated-value strategy="TABLE"/>
			</id>
			<basic name="serviceId">
				<column name="SERVICE_ID" length="25"/>
			</basic>
			<basic name="contextPath">
				<column name="CONTEXT_PATH" length="50"/>
			</basic>
			<basic name="type">
				<column name="TYPE" insertable="false" updatable="false"/>
			</basic>
			<element-collection name="streamDescriptions">
				<collection-table name="STREAM_DESC">
					<join-column name="SERVICE_ID"/>
				</collection-table>
			</element-collection>
		</attributes>
	</entity>

	<entity class="org.lecturestudio.web.api.model.MessageService" name="MessageService" access="FIELD">
		<table name="MESSAGE_SERVICE"/>
		<discriminator-value>MessageService</discriminator-value>
	</entity>

	<entity class="org.lecturestudio.web.api.model.StreamService" name="StreamService" access="FIELD">
		<table name="STREAM_SERVICE"/>
		<discriminator-value>StreamService</discriminator-value>
		<attributes>
			<basic name="audioCodec">
				<column name="AUDIO_CODEC"/>
			</basic>
			<basic name="audioFormat">
				<column name="AUDIO_FORMAT"/>
			</basic>
		</attributes>
	</entity>

	<entity class="org.lecturestudio.web.api.model.QuizService" name="QuizService" access="FIELD">
		<table name="QUIZ_SERVICE"/>
		<discriminator-value>QuizService</discriminator-value>
		<attributes>
			<basic name="quiz">
				<column name="QUIZ"/>
			</basic>
			<element-collection name="regexRules">
				<collection-table name="REGEX_RULE">
					<join-column name="SERVICE_ID"/>
				</collection-table>
			</element-collection>
			<element-collection name="hosts">
				<collection-table name="HOSTS">
					<join-column name="SERVICE_ID"/>
				</collection-table>
			</element-collection>
		</attributes>
	</entity>

	<embeddable class="org.lecturestudio.web.api.filter.IpRangeRule" access="FIELD" metadata-complete="true">
		<attributes>
			<basic name="from">
				<column name="IP_FROM"/>
			</basic>
			<basic name="to">
				<column name="IP_TO"/>
			</basic>
		</attributes>
	</embeddable>

	<embeddable class="org.lecturestudio.web.api.filter.RegexRule" access="FIELD" metadata-complete="true">
		<attributes>
			<basic name="regex">
				<column name="REGEX"/>
			</basic>
			<transient name="pattern"/>
		</attributes>
	</embeddable>

	<embeddable class="org.lecturestudio.web.api.model.StreamDescription" access="FIELD" metadata-complete="true">
		<attributes>
			<basic name="address">
				<column name="ADDRESS"/>
			</basic>
			<basic name="port">
				<column name="PORT"/>
			</basic>
			<basic name="transport">
				<column name="TRANSPORT"/>
			</basic>
			<basic name="mediaType">
				<column name="MEDIA_TYPE"/>
			</basic>
		</attributes>
	</embeddable>

</entity-mappings>